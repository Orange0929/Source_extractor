<!doctype html>
<html lang="ko" translate="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="google" content="notranslate" />
  <title>Voice Search MVP</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <header class="wrap header" translate="no">
    <div>
      <h1 class="notranslate">Voice Search (Local)</h1>
      <p class="sub notranslate">멀티 업로드 + 체크 일괄 삭제 + 병렬 STT + 취소 + 공유</p>
    </div>
  </header>

  <main class="wrap grid" translate="no">
    <!-- Left -->
    <section class="card">
      <h2 class="notranslate">프로필</h2>

      <div class="row">
        <input id="profileName" class="notranslate" placeholder="새 프로필 이름" />
        <button id="btnAddProfile" class="notranslate">추가</button>
      </div>

      <div class="row">
        <label class="label notranslate">현재 프로필</label>
        <select id="profileSelect" class="notranslate"></select>
        <button id="btnDeleteProfile" class="danger notranslate">프로필 삭제</button>
      </div>

      <!-- ✅ 공유 버튼 -->
      <div class="row">
        <button id="btnExportProfile" class="ghost notranslate" type="button">내보내기(zip)</button>

        <label class="filebtn notranslate">
          가져오기(zip)
          <input id="importZip" type="file" accept=".zip" />
        </label>
      </div>

      <hr />

      <h2 class="notranslate">음성 추가</h2>
      <form id="uploadForm">
        <input id="audioFile" class="notranslate" type="file" multiple accept=".wav,.mp3,.m4a,.flac,.ogg,.aac" />
        <button type="submit" class="notranslate">업로드</button>
      </form>

      <!-- ✅ 전체 진행(메인) + 전체 취소 -->
      <div id="masterBox" class="masterBox" style="display:none;">
        <div class="masterHead">
          <div class="masterTitle notranslate" translate="no">전체 진행</div>
          <div class="masterPct notranslate" translate="no" id="masterPct">0%</div>
        </div>

        <progress id="masterProgress" class="masterProgress" value="0" max="100"></progress>

        <div class="row" style="margin-top:10px;">
          <button id="btnCancelAll" class="danger notranslate" type="button">전체 취소</button>
          <button id="btnClearJobs" class="ghost notranslate" type="button">작업 목록 지우기</button>
        </div>

        <p class="hint notranslate" style="margin:8px 0 0;">
          전체 취소: 현재 업로드도 중단하고, 이미 올라간 STT 작업들은 모두 취소 요청합니다.
        </p>
      </div>

      <!-- ✅ 여러 job 진행 표시 -->
      <div id="jobsArea" class="jobsArea"></div>

      <p class="hint notranslate">
        업로드는 파일별로 진행되지만, 업로드된 파일들의 STT는 <b>동시에(병렬)</b> 진행됩니다.<br/>
        각 작업은 <b>취소</b>할 수 있어요.
      </p>
    </section>

    <!-- Right -->
    <section class="card">
      <h2 class="notranslate">검색</h2>

      <div class="row">
        <select id="searchMode" class="notranslate">
          <option value="basic" selected>기본(표기)</option>
          <option value="ko_sound">한국어 발음(연음/동화)</option>
          <option value="jp_sound">일본어 발음(로마자/한글→가나)</option>
        </select>
        <input id="searchInput" class="notranslate" placeholder="검색어" />
        <button id="btnSearch" class="notranslate">검색</button>
        <button id="btnReset" class="ghost notranslate">리셋</button>
      </div>

      <div class="row" style="margin-top:8px;">
        <button id="btnSelectAll" class="ghost notranslate" type="button">전체 선택</button>
        <button id="btnSelectNone" class="ghost notranslate" type="button">선택 해제</button>
        <button id="btnDeleteSelected" class="danger notranslate" type="button" disabled>선택 삭제(0)</button>
      </div>

      <div id="results" class="results"></div>

      <div class="player card-inner">
        <div class="player-row">
          <div class="player-title notranslate" id="playerTitle">재생할 항목을 선택하세요</div>
          <a id="downloadLink" class="download notranslate" href="#" download style="display:none;">다운로드</a>
        </div>
        <audio id="audioPlayer" controls preload="none"></audio>
      </div>

      <p class="hint notranslate">
        체크박스로 여러 클립을 선택해서 한 번에 삭제할 수 있습니다.
      </p>
    </section>
  </main>

  <footer class="wrap footer notranslate" translate="no">
    <span class="notranslate">Local only • FastAPI + faster-whisper + ffmpeg</span>
  </footer>

  <script src="/static/app.js"></script>
</body>
</html>
